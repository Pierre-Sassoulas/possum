{% extends "base.html" %}
{% load i18n %}
{% block content %}
<h1>{% trans "Modify products" %}</h1>
<div class="col-sm-6">
    <div class="panel panel-default panel-danger">
        <div class="panel-heading">
            <h3 class="panel-title">{% trans "Products on order" %}</h3>
        </div>
        <div class="panel-body">
            <ul class="list-unstyled">
                {% for sold in products_sold %}
                    {% if sold.count > 1 %}
                <li class="possum-base cat_{{sold.produit.categorie_id}}"
                    id="{{sold.id}}" href="javascript:void(0)"
                    onclick="javascript:myLinkButtonClick(this.id);">
                    {{sold.count}}x {{sold.produit.nom}}</li>
                <div id="list_{{sold.id}}" style="display: none">
                        {% for member in sold.members %}
                    <a href='{% url "sold_delete" bill.id member.id %}'>
                        <li class="possum-base cat_{{sold.produit.categorie_id}}">
                        {{member}} <span class="glyphicon glyphicon-remove"></span>
                    </li></a>
                        {% endfor %}
                </div>
                    {% else %}
                <a href='{% url "sold_delete" bill.id sold.id %}'>
                    <li class="possum-base cat_{{sold.produit.categorie_id}}">
                    {{sold}} <span class="glyphicon glyphicon-remove"></span>
                </li></a>
                    {% endif %}
                {% empty %}
                <li class="possum-base well">{% trans "No product" %}</li>
                {% endfor %}
            </ul>
            <p>{% trans "You can delete an item by selecting it" %}</p>
        </div>
    </div>
</div>
<div class="col-sm-6">
    <div class="panel panel-default">
        <div class="panel-body">
            <ul class="list-unstyled">
                <a href='{% url "bill_view" bill.id %}'>
                    <li class="possum-base alert-success">{% trans "Back" %}</li></a>
            </ul>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-body">
            <ul class="list-unstyled">
                {% for number in number_possible_to_add %}
                <div class="col-sm-2">
                    <li id="number_{{number}}" class="possum-base
                    {% if count == number %}alert-success{% else %}alert-info{% endif %}"
                    onclick="update_number(this, {{number}})">
                            {{number}}
                    </li>
                </div>
                {% endfor %}
            </ul>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-body">
            <ul class="list-unstyled">
                {% for category in categories %}
                <div class="col-sm-6">
                <li class="possum-base cat_{{category.id}}" id="{{category.id}}"
                    href="javascript:void(0)" onclick="javascript:view_category(this.id);">
                    {{category.nom}}
                </li></div>
                {% empty %}
                <li class="possum-base">{% trans "No category" %}</li>
                {% endfor %}
            </ul>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-body">
            <ul class="list-unstyled">
                {% for category in categories %}
                <div id="cat_{{category.id}}"
                    {% if current_cat != category.id %}style="display: none"{% endif %}>
                    {% for product in category.products %}
                    <div class="col-sm-6">
                        <a href='{% url "product_add" bill.id product.id %}'>
                        <li class="possum-base cat_{{category.id}}">{{product.nom}}
                        </li></a>
                    </div>
                    {% endfor %}
                </div>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>

<script>
    function update_number(element, number) {
        $.get('ajax/number_of_product/' + number);
        for (i = 1; i < {{max_number}}; i++) {
            document.getElementById("number_" + i).className="possum-base alert-info";
        }
        element.className="possum-base alert-success";
    }
</script>
{% endblock %}
